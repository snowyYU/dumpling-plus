import { Canvas, Story, ArgsTable, PRIMARY_STORY } from "@storybook/addon-docs";

# DpSchemaForm 配置表单

---

DpSchemaForm 提供一个可配置的可编辑表单组件，主要依靠 schema 表单项配置、model 数据集、\*props 配置透传字段以及 custom-update 或 update:model 数据更新事件配合，通过控制展示和更新数据以及数据验证来完成一个可编辑表单功能

### schema 字段说明

- visible: 是否展示
- layoutProps: 布局 col 透传 props
- formItemProps: form-item 透传 props
- fieldProps: 控件透传 props
- key: 表单项 item 唯一值
- type: 类型
  - module-custom: 自定义，配合 slot:`${item.key}-module-custom`
  - form-area-title: 配合 formAreaTitleType
  - rawtext: 原始文本，直接展示 item.key 对应的值
  - input: 输入控件
  - autocomplete: 输入控件，可进行数据筛选
  - input-number: 限定数字输入
  - textarea: 文本框
  - select: 下拉框
  - cascader: 级联选择器
  - radio: 单选
  - checkbox: 多选
  - switch: 开关
  - time-select: 时间选择
  - time-picker: 时间选择器
  - date-picker: 日期选择器
  - upload: 上传
  - custom: 自定义，渲染插槽 slot:`${item.key}-custom`
- customLabel: 自定义标签文本，配合 slots#`${item.key}-custom-label`
- customError: 自定义表单域验证错误时的提示信息，配合 slots#`${item.key}-custom-error`
- label: 标签
- formAreaTitleType: 当 type:form-area-title 时，展示的标题的样式，可选值：'newBlue'，默认为空
- height: 当 type:form-area-title 时，标题元素的高度
- ref: 当 type:cascader||upload 时，可定义控件 ref 以便获取该控件元素
- extendProps: 与当前表单项同后面层级扩展配置，可用户提示语或其他功能。展示的内容可以传入组件 slot 字段，也可配合 slots#`${item.key}-extend`
  - show:是否展示改扩展
  - slot:可将某个组件传入展示

### 补充说明

- 标签宽度默认为 100px
- type:select|cascader 默认加上 clearable 清空功能
- type:date-picker 中，fieldProps.type 提供快捷值转化，规则为
  - year: YYYY
  - month: YYYY-MM
  - date: YYYY-MM-DD
  - dates: YYYY-MM-DD
  - datetime: YYYY-MM-DD HH:mm:ss
  - datetimerange: YYYY-MM-DD HH:mm:ss
  - daterange: YYYY-MM-DD
  - monthrange: YYYY-MM
- type:date-picker 中，fieldProps.type 是范围类型（即 fieldProps.type 包含 range 字样），不提供默认 placeholder，其他均提供

### 基础类型大全

展示出基本类型 type

<Canvas>
  <Story id="dpschemaform-配置表单--base" />
</Canvas>

### 表单验证

- 通过设置 schema.customLabel:ture 并且配合 slot:`${item.key}-custom`可自定义标签
- 通过设置 schema.customError:ture 并且配合 slot:`${item.key}-error`可自定义错误信息内容
- 通过定义组件 ref，可获取表单组件实例，通过实例可得表单验证事件：
  - validate: 验证全部表单
  - validateField: 传入 string[]，可验证部分表单
  - clearValidate: 传入 string[]，可清除部分表单验证错误信息，默认清除全部
  - resetFields: 重置全部表单数据并且清除错误信息

<Canvas>
  <Story id="dpschemaform-配置表单--validate" />
</Canvas>

### 日期选择器

<Canvas>
  <Story id="dpschemaform-配置表单--date-picker" />
</Canvas>

<ArgsTable story={PRIMARY_STORY} />
